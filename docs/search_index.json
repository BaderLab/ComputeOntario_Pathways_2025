[["index.html", "Compute Ontario - Bioinformatics for Pathway Enrichment Analysis ( June 2025 ) Compute Ontario Summer School", " Compute Ontario - Bioinformatics for Pathway Enrichment Analysis ( June 2025 ) Ruth Isserlin, Veronique Voisin last modified 2025-04-29 Compute Ontario Summer School This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Icons are from the “Very Basic. Android L Lollipop” set by Ivan Boyko licensed under CC BY 3.0 and Icons8. "],["welcome.html", "Welcome Meet your Faculty Class Materials Workshop Schedule Pre-Workshop Materials and Laptop Setup Instructions Pre-workshop Tutorials", " Welcome Welcome to Bioinformatics for Pathway Enrichment Analysis - June 2025 Meet your Faculty Veronique Voisin Research Associate, Donnelly Centre for Cellular and Biomolecular Research, University of Toronto Veronique is currently a bioinformatician applying pathway and networks analysis to high throughput genomics data for OICR cancer stem cell program. Previously, she worked on characterizing the gene signatures of different types of leukemias using a murine model     Ruth Isserlin Research data analyst,Donnelly Centre for Cellular and Bimolecular Research, University of Toronto Bioinformatician and data analyst in the Bader lab applying pathway and data analysis to varied data types. Developed Enrichment Map App for Cytoscape, an app to visually translate functional enrichment results from popular enrichment tools like GSEA to networks. Further developed the Enrichment Map Pipeline including development of additional Apps to help summarize and analyze resulting Enrichment Maps, including PostAnalysis, WordCloud, and AutoAnnotate App. Thank you for attending the Bioinformatics for Pathway Enrichment Analysis workshop! Help us make this workshop better by filling out our survey. Class Materials You can download the printed course manual here. Workshop Schedule Pre-Workshop Materials and Laptop Setup Instructions Laptop Setup Instructions A Check list to setup your laptop can be found here Install these tools on your laptop before coming to the workshop: Basic programs A robust text editor: For Windows/PC - notepad++ For Linux - gEdit For Mac – TextWrangler A file decompression tool. For Windows/PC – 7zip. For Linux – gzip. For Mac – already there. A robust internet browser such as: Firefox Safari Chrome Microsoft Edge A PDF Viewer Adobe Acrobat or equivalent Cytoscape Installation Please install the latest version of Cytoscape 3.10.2 or Cytoscape Download as well as a group of Cytoscape Apps that we will be using for different parts of the course. Install Cytoscape 3.10.2: Go to: https://github.com/cytoscape/cytoscape/releases/3.10.2/ OR https://cytoscape.org/download.html Choose the version corresponding to your operating system (OS, Windows or UNIX) Follow instructions to install cytoscape Verify that Cytoscape has been installed correctly by launching the newly installed application Install the following Cytoscape Apps - Apps are installed from within Cytoscape. In order to install Apps launch Cytoscape From the menu bar, select ‘Apps’, then ‘App Store’, then ‘Show App Store’. App Store will appear in left hand Panel Within search bar at the top of the panel, search for the app listed below. Once you click on search icon a web browser will be launched with the apps that match your search. Select the correct app (there might be a few that match your search term). Click on “Install” install the following: EnrichmentMap 3.4.0 EnrichmentMap Pipeline Collection 1.1.0 (it will install ClusterMaker2 v2.3.4, WordCloud v3.1.4 and AutoAnnotate v1.5.0) GeneMANIA 3.5.3 IRegulon 1.3 ReactomeFIPlugin 8.0.6 - http://apps.cytoscape.org/apps/reactomefiplugin stringApp 2.0.3 scNetViz 1.7.1 yFiles Layout Algorithms 1.1.4 Install the data set within GeneMANIA app. This requires time and a good network connection to download completely (~15mins) From the menu bar, select ‘Apps’, hover over ‘GeneMANIA’, then select ‘Choose Another Data Set’. From the list of available data sets, select the most recent and under ‘Include only these networks:’ select ‘all’. Click on ‘Download’. An ‘Install Data’ window will pop-up. Select H.Sapiens Human (2589 MB). Click on ‘Install’. GSEA Installation Please install the latest version of GSEA (4.3.3) Download GSEA Go to the GSEA page Register (using an institutional email address) Login Locate the Download page and download the version corresponding to your system MAC users: download GSEA_4.3.3.app.zip Window users: download GSEA_Win_4.3.3-installer.exe Unix users: download GSEA_Linux_4.3.3.zip Launch GSEA to test it. Download GSEA for command line : this is necessary for all platform users to run GSEA from a script (integrated workflow on day 3) Download GSEA_4.3.3.zip (and keep it for later use during the workshop) Docker Installation Docker is a virtualization software that allows you to run programs isolated from your current laptop set up. It eases the burden of installing multiple software requirements and packages. Please install the latest version of Docker Desktop. Windows OSX - make sure to select the version specific for your computer. Newer macs (later than 2021) will contain the Apple silicon (M1/M2/M3). Older computers might be intel based. Linux Pull the required images used in the course Open docker desktop (If docker is already running you can find the docker icon in your task bar. Right click on the icon and select “Go to Dashboard”) Find the search bar in the docker desktop dashboard Enter “risserlin/workshop_base_image” into the search bar at the top of the docker desktop dashboard. Click on “Pull” to download the image. Enter “risserlin/nest_docker_lymphnode” into the search bar at the top of the docker desktop dashboard. Click on “Pull” to download the image. You should now see both of your images listed in the docker desktop image section (in the local tab) Pre-workshop Tutorials It is in your best interest to complete these before the workshop. Cytoscape Preparation tutorials Go to : https://github.com/cytoscape/cytoscape-tutorials/wiki and follow : Tour of Cytoscape Basic Data Visualization R Tutorial Use your newly installed docker workshop_base_image to try out R and go through the following tutorial - R tutorial - There will be instructions on how to install R and RStudio in the tutorial. Instead of installing use the workshop_base_image docker image that you installed above as follows: Open docker desktop (If docker is already running you can find the docker icon in your task bar. Right click on the icon and select “Go to Dashboard”) Click on Images –&gt; Local –&gt; And find the workshop_base_image. click on the Play button Expand the ‘optional settings’ Change - ‘container name’ to R_tutorial, ‘Host Port’ to 8787, Add environment variable PASSWORD and set value to password Click on ‘Run’. Docker will display a tab with all the information about the container you just launched Open a web browser and navigate to localhost:8787 Username - rstudio, password - password (or whatever you entered as the PASSWORD settting when you launch the container) You should now have an r studio session running in your web browser When you are finished doing the tutorial remember to turn off your docker container and dacker as they both use up a lot of your computer’s resources. Pre-workshop Readings and Lectures Video Module 1 - Introduction to Pathway and Network Analysis by Gary Bader Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Reimand J, Isserlin R, Voisin V, Kucera M, Tannus-Lopes C, Rostamianfar A, Wadi L, Meyer M, Wong J, Xu C, Merico D, Bader GD Nat Protoc. 2019 Feb;14(2):482-517 - Available here as well Additional tutorials How to visually interpret biological data using networks Merico D, Gfeller D, Bader GD Nature Biotechnology 2009 Oct 27, 921-924 - Available here as well g:Profiler–a web-based toolset for functional profiling of gene lists from large-scale experiments. Reimand J, Kull M, Peterson H, Hansen J, Vilo J Nucleic Acids Res. 2007 Jul;35 g:Profiler: a web server for functional enrichment analysis and conversions of gene lists (2019 update) Raudvere U, Kolberg L, Kuzmin I, Arak T, Adler P, Peterson H, Vilo J Nucleic Acids Res. 2019 May 8 Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles Subramanian A, Tamayo P, Mootha VK, Mukherjee S, Ebert BL, Gillette MA, Paulovich A, Pomeroy SL, Golub TR, Lander ES, Mesirov JP Proc Natl Acad Sci U S A. 2005 Oct 25;102(43) Interacting with Cytoscape using CyRest and command lines (for advanced users): https://github.com/cytoscape/cytoscape-automation/blob/master/for-scripters/R/advanced-cancer-networks-and-data-rcy3.Rmd "],["intro.html", "Module 1 - Introduction to Pathway and Network Analysis (Gary Bader)", " Module 1 - Introduction to Pathway and Network Analysis (Gary Bader) Lecture Recorded Lecture 1 "],["module-2-finding-over-represented-pathways-veronique-voisin.html", "Module 2: Finding Over-represented Pathways (Veronique Voisin)", " Module 2: Finding Over-represented Pathways (Veronique Voisin) Veronique Voisin and Ruth Isserlin Lecture Introduction to practical lab Lab practical part 1 (g:Profiler) Lab practical part 2 (GSEA) "],["gprofiler-lab.html", "Module 2 lab - g:Profiler Introduction Goal of the exercise 1 Data Exercise 1 - run g:Profiler Exercise 2: Load and use a custom .gmt file and run the query Optional steps Bonus - Automation.", " Module 2 lab - g:Profiler This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. Introduction Performing Over-Representation Analysis (ORA) with g:Profiler. The practical lab contains 2 exercises. The first exercise uses g:Profiler to perform gene-set enrichment analysis. Goal of the exercise 1 Learn how to run g:GOSt Functional profiling from the g:Profiler website and explore the results. Data g:Profiler requires a list of genes, one per line, in a text file or spreadsheet, ready to copy and paste into a web page: for this, we use genes with frequent somatic SNVs identified in TCGA exome sequencing data of 3,200 tumors of 12 types. The MuSiC cancer driver mutation detection software was used to find 127 cancer driver genes that displayed higher than expected mutation frequencies in cancer samples (Supplementary Table 1, which is derived from column B of Supplementary Table 4 in Kandoth C. et al.. Genes are ranked in decreasing order of significance (FDR Q value) and mutation frequency (not shown). Exercise 1 - run g:Profiler For this exercise, our goal is to run an analysis with g:Profiler. We will copy and paste the list of genes into the g:Profiler web interface, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. g:Profiler performs a gene-set enrichment analysis using a hypergeometric test (Fisher’s exact test) with the option to consider the ranking of the genes in the calculation of the enrichment significance (minimum hypergeometric test). The Gene Ontology Biological Process, Reactome and WikiPathways sources are going to be used as pathway databases. The results are displayed as a table or downloadable as an Generic Enrichment Map (GEM) output file. Before starting this exercise, download the required files: Right click on link below and select “Save Link As…”. Place it in the corresponding module directory of your CBW work directory. Pancancer_genelist.txt We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. Step 1 - Launch g:Profiler. Open the g:Profiler website at g:Profiler in your web browser. Step 2 - input query Paste the gene list (Pancancer_genelist.txt) into the Query field in top-left corner of the screen. Open the file in a simple text editor such as Notepad or Textedit to copy the list of genes. Or right click on the file name above and select Open link in new tab The gene list can be space-separated or one per line. The organism for the analysis, Homo sapiens, is selected by default. The input list can contain a mix of gene and protein IDs, symbols and accession numbers. Duplicated and unrecognized IDs will be removed automatically, and ambiguous symbols can be refined in an interactive dialogue after submitting the query. Highlight driver terms in GO is a recently (April 2023) added feature that tries to reduce the number of GO terms returned by g:Profiler and highlight a non-redundant set of GO terms. For more detailed information on this feature see here Step 3 - Adjust parameters. 3a. Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to “Benjamini-Hochberg FDR” User threshold - select 0.05 if you want g:Profiler to return only pathways that are significant (FDR &lt; 0.05). If g:Profiler does not return any results increase the threshold (0.1, then 1) to check that g:Profiler is running successfully but there are simply no significant results for your query. By default, g:Profiler will only return the sets that pass the defined threshold. Often you need the ability to tweak the thresholds in the resulting EM beyond the strict FDR &lt; 0.05 threshold and therefore require all the results. In order to get all the results, even those that don’t pass correction, select All results. 3b. Click on the Data sources tab (black rectangle) to expand it. Unselect all gene-set databases by clicking the “clear all” button. In the Gene Ontology category, check GO Biological Process and No electronic GO annotations. In the biological pathways category, check Reactome and check WikiPathways. No electronic GO annotations option will discard less reliable GO annotations (inferred from electronic annotations (IEAs)) that are not manually reviewed. if g:Profiler does not return any results uncheck the No electronic GO annotation option to expand annotations used in the test. Step 4 - Run query Click on the Run query button, below the input parameters, to run g:Profiler. Scroll down page to see results. After clicking on Run query button, the analysis completes but if there is the following message (above results) - Select the Ensembl ID with the most GO annotations (all), then do the following. For each ambiguous gene, select its correct mapping. Ambiguous mapping is often caused by multiple Ensembl ids for a given gene and are easy to resolve as a user. Rerun query. Step 5 - Explore the results. Step 5a: After the query has run, the results are displayed at the bottom of the page, below the input parameters. By default, the “Overview” tab is selected. A global graph displays gene-sets that passed the significance threshold of 0.05 for each of the 3 data sources (shown on x-axis) that we have selected - GO Biological Process(GO:BP) and Reactome(REAC) and WikiPathways(WP). Numbers in parentheses indicate the number of gene-sets that passed the threshold. Step5b: Click on “Detailed Results” to view the results in more depth. Three tables are displayed, one for each of the data sources selected. (If more than 3 data sources are selected there will be additional tables for each data source). Each row of the table contains: Term name - gene-set name Term ID - gene-set identifier Padj - FDR value -log10(Padj) - enrichment score calculated using the formula -log10(padj) Variable number of gene columns (One for each gene in the query set) - If the gene is present in the current gene-set its cell is colored. For any data source besides GO, the cell is colored black if the gene is found in the gene-set. For the GO data source cells are colored according to the annotation evidence code. Expand the Legend tab for detailed coloring mapping of GO evidence codes. The first table displays the gene-sets significantly enriched at FDR 0.05 for the GO:BP database. The second table displays the results corresponding to the Reactome database. The third table displays the results corresponding to the WikiPathways database. Step 6: Expand the stats tab Expand the stats tab by clicking on the double arrow located at the right of the tab. It displays the gene set size (T), the size of our gene list (Q) , the number of genes that overlap between our gene list and the tested gene-set (TnQ) as well as the number of genes in the background (U). Above the GO:BP result table, locate the slide bar that enables to select for the minimum and maximum number of genes in the tested gene-sets (Term size). Change the maximum Term size from 10000 to 250 and Change the minimum Term size from 1 to 3 and Observe the results in the detailed stats panel: Without filtering term size, the top terms were GO terms containing more than 4000 or 5000 genes and often terms located high in the GO hierarchy (parent term). With filtering the maximum term size to 250, the top list contains pathways with larger interpretative values. However, please note that the adjusted p-values were calculated using all gene-sets without size filtering. Step 7: Save the results 7a. In the Detailed Results panel, select “GEM” . It will save the results in a text file in the “Generic Enrichment Map” format that we will use to visualize using Cytoscape. keep the minimum term size set to 3 (for all the three files we create below) set maximum term size to 10000 ( = no filtering by gene-set size) and click on the GEM button. A file is downloaded on your computer. (change the name to gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000.gem.txt) set maximum term size to 1000 ( = filter by gene-set size) and click on the GEM button. A file is downloaded on your computer. (change the name to gProfiler_hsapiens_lab2_results_GEM_termmin3_max1000.gem.txt) select max term size to 250 ( = filter by gene-set size) and click on the GEM button. A file is downloaded on your computer. (change the name to gProfiler_hsapiens_lab2_results_GEM_termmin3_max250.gem.txt) 7b: Open the file that you saved using the gene-set threshold of 250 using Microsoft Office Excel or in an equivalent software. Observe the results included in this file: Name of each gene-set Description of each gene-set Significance of the overlap (pvalue) Significance of the overlap (adjusted pvalue/qvalue) Phenotype Genes included in each gene-set Which GO:BP term has the best corrected p-value? Which genes in our list are included in this term? Observe that some genes can be present on several lines (pathways are related when they contain a lof of genes in common). The table is formatted for the input into Cytoscape EnrichmentMap. It is called the generic format. The p-value and FDR columns contain identical values because g:Profiler directly outputs the FDR (= corrected p-value) meaning that the p-value column is already the FDR. Phenotype 1 means that each pathway will be represented by red nodes on the enrichment map (presented during next module). The GO:BP term regulation of cell cycle G1/S phase transition is the most significant gene-set (=the lowest FDR value). Many gene-sets from the top of this list are related to each other and have genes in common. Step 8 (Optional but recommended) 8a. Download the pathway database files. Go to the top of the page and expand the “Data sources” tab. Click on the ‘combined name.gmt’ link located at bottom of this tab. It will download a file named combined name.gmt containing a pathway database gmt file with all the available sources. 8b. concatenate the GO:BP, Reactome and WikiPathways gmt files: If you want to create a smaller gmt file that doesn’t contain all of the g:profiler datasources you can instead download name.gmt.zip that contains each datasource as its own gmt file. You will need to concatenate the sources you require into one gmt file to use for later. Option 1: manually if you are not familiar with unix commands open a text editor such a Notepad or equivalent open hsapiens.GO:BP.name.gmt using the text editor open gmt hsapiens.REAC.name.gmt using the text editor copy-paste all the rows from REAC file together with all the rows in GO:BP file. open gmt hsapiens.WP.name.gmt using the text editor copy-paste all the rows from WP file together with all the rows in GO:BP file. save the file as hsapiens.pathways.name.gmt . Option 2: using the cat command if you are familiar with unix commands open your terminal window cd to the unzipped gprofiler_hsapiens.name folder type the following command: cat hsapiens.GO:BP.name.gmt hsapiens.REAC.name.gmt hsapiens.WP.name.gmt &gt; hsapiens.pathways.name.gmt you will be using this optional hsapiens.pathways.name.gmt file in Cytoscape EnrichmentMap. Step 9 (Optional by recommended) Get and record the version of g:Profiler used in your analysis. It is important to note in your future publication using your enrichment results the methods and the version of software used for any analysis. g:Profiler is updated on a regular basis so you can not simply come back to the webpage at time of publication and get the version. Also, if you ever want to verify the results that you have and re-run the analysis it is important to use the same version as the initial analysis (or your results might differ). g:Profiler maintains an archive so it is easy to revisit previous versions. The g:Profiler version can be found in two places - At the bottom of overview tab the version is listed Or Click on the Query Info tab to see all the parameters, including the g:Profiler version, used for the analysis Deciphering the version from the listed tag e111_eg58_p18_b51d8f08 : * e111 - Ensembl version 111 * eg56 - Ensembl genomes version 58 The version info can be recorded anywhere (for example in your lab notebook) but a convenient place is to embed it in the g:Profiler geneset file name used for the analysis. Instead of naming the file * hsapiens.pathways.name.gmt Name it * hsapiens.pathways_e111_eg58_p18_b51d8f08.name.gmt Exercise 2: Load and use a custom .gmt file and run the query For this exercise, our goal is to copy and paste the list of genes into g:Profiler, upload a custom gmt file, adjust some parameters (e.g selecting the pathway databases), run the query and explore the results. Uploading a custom gmt file enables us to use alternate pathway data sources not available in g:Profiler. We are going to use a gmt file that contains a database of pathway gene sets used for pathway enrichment analysis in the standard GMT format downloaded from http://baderlab.org/GeneSets and updated monthly. This file contains pathways from eight data sources: GO, Reactome, Panther, NetPath, NCI, MSigDB curated gene sets (C2 collection, excluding Reactome and KEGG), MSigDB Hallmark (H collection) and HumanCyc. A GMT file is a text file in which each line represents a gene set for a single pathway. Each line includes a pathway ID, a name and the list of associated genes in a tab-separated format. This file has been filtered to exlclude gene-sets that contained more than 250 genes as these gene-sets are associated with more general terms. Before starting this exercise, download the required files: Right click on link below and select “Save Link As…”. Place it in the corresponding module directory of your CBW work directory. Pancancer_genelist.txt Baderlab_genesets.gmt (from June 2024). We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. STEPS: Repeat step 1 to 3a from Exercise 1 (go back to exercise 1 to get detailed instructions) Briefly: Step 1: Open g:profiler Step 2a : Copy and paste the gene list in the Query field Step 2b: Click on the Advanced options tab (black rectangle) to expand it. Set Significance threshold to “Benjamini-Hochberg FDR”. Step 3a: Click on the Data sources tab (black rectangle) to expand it. Unselect all choices by clicking the “clear all” button. Step 4: Click on the Custom GMT tab (black rectangle) to expand it. Drag in the box the Baderlab gmt file Baderlab_genesets.gmt. Once uploaded successfully, the name of the file is displayed in the “File name used” box. Step 5: Click on Run query . Step 6: Explore the detailed results Step 7: Save the file as GEM (rename file to gProfiler_hsapiens_Baderlab_max250.gem.txt) Optional steps Please follow these optional steps if time permits and/or to explore more g:Profiler parameters. Here below are 3 optional steps that cover several options offered by g:Profiler: test different data sources, take the order of the gene list into account, use different types of multiple hypothesis correction methods. Use the same gene list as used in exercise 1 and modify paramters listed above. Observe the results. Optional 1: If time permits, play with input parameters, e.g. add TRANSFAC and miRTarBase databases, rerun the query and explore the new results. Transfac putative transcription factor binding sites (TFBSs) from TRANSFAC database are retrieved into g:GOSt through a special prediction pipeline. First, TFBSs are found by matching TRANSFAC position specific matrices using the program Match on range +/-1kb from TSS as provided by APPRIS (Annotating principal splice isoforms) via Ensembl biomart. For genes with multiple primary TSS annotations we selected one with most TF matches. The matching range for C. elegans, D. melanogaster and S. cerevisiae is 1kb upstream from ATG (translation start site). A cut-off value to minimize the number of false positive matches (provided by TRANSFAC) is then applied to remove spurious motifs. Remaining matches are split into two inclusive groups based on the amount of matches, i.e TFBSs that have at least 1 match are classified as match class 0 and TFBSs that have at least 2 matches per gene are classified as match class 1. mirTarBase is a database that holds experimentally validated information about genes that are targetted by miRNAs. We include all the organisms that are covered by mirTarBase. Option 2: Re-run the g:Profiler using the ordered query checked. This will run the minimum hypergeometric test. g:Profiler then performs incremental enrichment analysis with increasingly larger numbers of genes starting from the top of the list. When this option is checked, it assumes that the genes were preordered by significance with the most significant gene at the top of the list. Compare the results between “ordered” and non ordered query. for this practical lab, the genes were ordered by the number of mutations found in these genes for all samples. For example, TP53, a highly mutated genes is listed at the top. Option 3 : Re-run g:Profiler and select g:SCS or Bonferonni as method to correct for multiple hypothesis testing. Do you get any significant results? you can get detailed information about these methods at https://biit.cs.ut.ee/gprofiler/page/docs in the section Significance threshold. Bonus - Automation. Run analysis directly from R for easy integration into existing pipelines. Instead of using the g:Profiler website g:profiler can be run directly from R or python see g:Profiler document for more info at https://biit.cs.ut.ee/gprofiler/page/r Follow the step by step instructions on how to run from R here - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/run-gprofiler-from-r.html First, make sure your environment is set up correctly by following there instructions - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/setup.html "],["gsea-lab.html", "Module 2 lab - GSEA Introduction Goal of the exercise Data Background Additional information Bonus - Automation.", " Module 2 lab - GSEA Presenter: Ruth Isserlin Introduction This practical lab contains one exercise. It uses GSEA to perform a gene-set enrichment analysis. Goal of the exercise Learn how to run GSEA and explore the results. Data The data used in this exercise is gene expression (transcriptomics) obtained from high-throughput RNA sequencing of Pancreatic Ductal Adenocarcinoma samples (TCGA-PAAD). This cohort has been previously stratified into many different set of subtypes PMID:36765128 with the Moffitt Basal vs Classical subtypes compared to demonstrate the GSEA workflow. How was the data processed? Gene expression from the TCGA Pancreatic Ductal Adenocarcinoma RNASeq cohort was downloaded on 2024-06-06 from Genomic Data Commons using the TCGABiolinks R package. Differential expression for all genes between the Basal and Classical groups was estimated using edgeR. The R code used to generate the data and the rank file used in GSEA is included at the bottom of the document in the Additional information section. Background The goal of this lab is to: Upload the 2 required files into GSEA, Adjust relevant parameters, Run GSEA, Open and explore the gene-set enrichment results. The 2 required files are: a rank file (.rnk) a pathway definition file (.gmt). Rank File To generate a rank file (.rnk), a score (-log10(pvalue) * sign(logFC)) was calculated from the edgeR differential expression results. A gene that is significantly differentially expressed (i.e associated with a very small pvalue, close to 0) will be assigned a high score.The sign of the logFC indicates if the gene has an expression which is higher in Basel (logFC &gt; 0, the score will have a + sign) or lower in Classical (logFC &lt; 0, the score will have a - sign). It is used to rank the genes from top up-regulated to top down-regulated (all genes have to be included). The rank file is going to be provided for the lab, you don’t need to generate it. How to generate a rank file. Calculation of the score Generation of the rank file Select the gene names and score columns and save the file as tab delimited with the extension .rnk Pathway defintion file The second file that is needed for GSEA is the pathway database, a file with the .gmt extension. The pathway database (.gmt) used for the GSEA analysis was downloaded from http://baderlab.org/GeneSets. This file contains gene-sets obtained from MsigDB-c2 and Hallmarks, NCI, Biocarta, IOB, Netpath, HumanCyc, Reactome, Panther, Pathbank, WikiPathways and the Gene Ontology (GO) databases. You don’t need to perform this step for the exercise, the .gmt file will be given to you. Go to: http://download.baderlab.org/EM_Genesets/ Click on June_01_2024/ Click on Human/ Click on symbol/ Save the Human_GOBP_AllPathways_noPFOCR_no_GO_iea…gmt file on your computer The .gmt is a tab delimited text file which contains one gene-set per row. For each gene-set (row), the first 2 columns contain the name and the description of the gene-set and the remaining columns contain the list of genes included in the gene-set. It is possible to create a custom gene-set using Excel or R. GSEA performs a gene-set enrichment analysis using a modified Kolmogorov-Smirnov statistic. The output result consists of summary tables displaying enrichment statistics for each gene-set (pathway) that has been tested. Start the exercise Before starting this exercise, download the 2 required files: Right click on link below and select “Save Link As…”. Place it in the corresponding module directory of your CBW work directory. Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol.gmt TCGA-PAAD_GDC_Subtype_Moffitt_BasalvsClassical_ranks.rnk Step1. Launch GSEA by double clicking on the installed program icon. If GSEA won’t launch on MacOS. (This is relevant for MacOS users on older operating systems. As I am not longer on this operating system I can’t regenerate these screenshots so they reflect an older version of GSEA but the steps are still relelvant if you are working on Catalina with the latest version of GSEA) Follow instructions specified on download page: * If you see this error message: Open Settings -&gt; Security &amp; Privacy Click on “Open Anyways” Step 2. Load Data 2a. Locate the ‘Load data’ icon at the upper left corner of the window and click on it. 2b. In the central panel, select ‘Method 1’ and ‘Browse for files’. A new window pops up. 2c. Browse your computer to locate and select the 2 files : Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol.gmt and TCGA-PAAD_GDC_Subtype_Moffitt_BasalvsClassical_ranks.rnkk. 2d. Click on Open. A message pops us when the files are loaded successfully. 2e. Click on OK. Alternatively, you can choose Method 3 to drag and drop files here. You need to click on the Load these files! button in this case. Step3. Adjust parameters 3a. Under the Tools menu select GseaPreRanked. 3b. Run GSEA on a Pre-Ranked gene list tab will appear. Specify the following parameters: 3c. Gene sets database - Click on the radio button (…) located at the right of the blank field. Wait 5-10 sec for the gene-set selection window to appear. Use the right arrow in the top field to see the Gene matrix (Local gmx/gmt) tab. Click to highlight Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol.gmt. Click on OK at the bottom of the window. Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol.gmt is now visible in the field corresponding to Gene sets database. 3d. Set Number of permutations to 100. The number of permutations is the number of times that the gene-sets will be randomized in order to create a null distribution to calculate the FDR. Use 2000 when you do it for your own data outside the workshop. 3e. Ranked list - select by clicking on the arrow and highlighting rank file. 3f. Collapse/Remap to gene symbols - Change to No_collapse. (Our rank file already contains the gene symbols so we don’t need GSEA to try and convert probe names to gene symbols) 3g. Click on Show button next to Basic Fields to display extra options. 3h. Analysis name – change the default name my_analysis to a name that is specific to analysis. For example Basal_vs_Classical_edgeR. GSEA will use your specified name as part of the directory of results that it creates. 3i. Max size: exclude larger sets – By default GSEA sets the upper limit to 500. In this protocol, the maximum is set to 200 to decrease some of the larger sets in the results. 3j. Min size: exclude smaller sets – By default GSEA sets the lower limit to 15. In this protocol, the minimum is set to 10 to increase some of the smaller sets in the results. 3k. Save results in this folder – navigate to where you want GSEA to put the results folder. By default GSEA will put the results into the directory gsea_home/output/[date] in your home directory. Set Enrichment Statistics to p2 if you want to add more weight on the most top up-regulated and top down-regulated. P2 is a more stringent parameter and it will result in less gene-sets significant under FDR &lt;0.05. Step 4. Run GSEA 4a. Click on Run button located at the bottom right corner of the window. Expand the window size if the run button is not visible 4b. On the panel located on the left side of the GSEA window, the bottom panel called GSEA report will show that a process was created, with a message that it is Running. On completion the status message will be updated to Success…. There is no progress bar to indicate to the user how much time is left to complete the process. Depending on the size of your dataset and compute power of your machine, a GSEA run can take from a few minutes to a few hours. To check on the status of the GSEA run in the bottom left hand corner you can click on the + (red circle in above Figure) to see the updating status. Printouts in the format shuffleGeneSet for GeneSet 5816/6878 nperm: 100 indicate how many permutations have been done (5816) out of the total that need to be performed (6878). If the permutations have been completed but the status is still running, it means that GSEA is creating the report Java Heap Space error. If GSEA returns an error Java Heap space it means that GSEA has run out of memory. If you are running GSEA from the webstart other than the 4GB option, then you will need to download a new version that allows for more memory allocation. The current maximum memory allocation that the GSEA webstart allows for is 4GB. If you are using this version and still receive the java heap error, you will need to download the GSEA java jar file and launch it from the command line as described in step 1. Step 5. Examining the results 5a. Click on Success to launch the results in html format in your default web browser. If the GSEA application has been closed, you can still see the results by opening the result folder and clicking on the index file – index.html. (see screenshot below). The first phenotype corresponds to gene-sets enriched in genes up-regulated in the Basal subtype. The second phenotype corresponds to gene-sets enriched in genes up-regulated in the Classical phenotype. When examining the results there are a few things to look for: 5b. Check the number of gene-sets that have been used for the analysis. A small number (a few hundred genesets if using baderlab genesets) could indicate an issue with identifier mapping. 5c. Check the number of sets that have FDR less than 0.25 – in order to determine what thresholds to start with when creating the enrichment map. It is not uncommon to see a thousand gene sets pass the threshold of FDR less than 0.25. FDR less than 0.25 is a very lax threshold and for robust data we can set thresholds of FDR less than 0.05 or lower. 5d. Click on Snapshots to see the trend for the top 20 genesets. For the positive phenotype the top genesets should show a distribution skewed to the left (positive) i.e. genesets have predominance of up-regulated genes. For the negative phenotype the top geneset should be inverted and skewed to the right (negative) i.e. geneset have predominance of down-regulated genes. 5e. Explore the tabular format of the results. Basal Classical Link to information about GSEA results Additional information More on GSEA data format More on processing the RNAseq using EdgeR and generate the .rank file More on which .gmt file to download from the Baderlab gene-set file, select current release, Human, symbol, Human_GOBP_AllPathways_no_GO_iea_….gmt More on GSEA : link to the Baderlab wiki page on GSEA Bonus - Automation. Run analysis directly from R for easy integration into existing pipelines. Instead of using the GSEA application you can run it directly from R using the GSEA java jar that can be easily used within the workshop docker image (workshop_base_image) that you setup duing your prework. Follow the step by step instructions on how to run from R here - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/run-gsea-from-within-r.html First, make sure your environment is set up correctly by following there instructions - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/setup.html "],["module-3-network-visualization-and-analysis-with-cytoscape.html", "Module 3: Network Visualization and Analysis with Cytoscape", " Module 3: Network Visualization and Analysis with Cytoscape Ruth Isserlin Module 3 Cytoscape Cytoscape - Lecture Module 3 Cytoscape Lab Introduction to practical Cytoscape Lab (slides) Lab practical Cytoscape Primer Module 3 Enrichment Map Enrichment Map Lecture Module 3 Enrichment Map Lab Introduction to practical EM Lab (slides) Lab practical part 1 (g:Profiler) Lab practical part 2 (GSEA) "],["cytoscape_mod3.html", "Module 3 Lab Primer: Cytoscape Primer Goal of the exercise Data Start the exercise Exercise 1a - Create Network from table Exercise 1b - Load node attributes Exercise 1c - Map node attributes to Visual Style Exercise 2 - Work with larger networks Exercise 3 - Perform basic enrichment analysis using EnrichmentTable Exercise 3B - create Enrichment Map and Enhanced graphics nodes from EnrichmentTable Exercise 4 - Load network from NDex", " Module 3 Lab Primer: Cytoscape Primer This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Gary Bader, Ruth Isserlin, Chaitra Sarathy, Veronique Voisin Goal of the exercise Create a network and customize it. The goal of this exercise is to learn how to create a network in Cytoscape and customize id. In this example, the proteins are the entities represented as nodes in the network and known physical interactions are the connections between the proteins that are represented as edges. We will overlay 2 additional pieces of information about these proteins, mutation information per protein as node color and mutation expression as node size. Data The data used in this exercise is a set of protein - protein interactions and associated attributes. Start the exercise To start the lab practical section, first create a cytoscape_primer_files directoty on your computer and download the files below. Right click on link below and select “Save Link As…”. Place it in the corresponding module directory of your CBW work directory. Two files are needed for this exercise: networktable.txt nodeattribute.txt Exercise 1a - Create Network from table Launch Cytoscape Locate the top menu bar and select File,–&gt; Import, –&gt; Network from File…. Browse your computer and select the file networktable.txt An Import Network from Table dialog box opens. The 3 columns of the table should be set as “source”, “interaction” and “target” respectively. Cytoscape will assume, by default, will look for the column names that start with “source”, “interaction” and “target”. It will assume that any other column is an interaction attribute (edge attribute) This is just an example file. You can import files with any number of additional columns and choose to ignore all columns except for the ones that you want to import or import all of them. Although Cytoscape tries to guess the data type of each column and the type (ie. is it an attribute associated with source node, target nodes or the interaction) you are able to fine tune everything. Click “Ok”. A network containing the proteins as blue square nodes and interaction as edges should be displayed in the main Cytoscape window. Exercise 1b - Load node attributes Locate the Cytoscape top menu bar and select File,–&gt; Import,–&gt; Table from File…. Browse your computer and select the file nodeattribute.txt click “Open”. An “Import Table from Columns” dialog appears. Click on “OK”. You should be able to see the imported attributes in the node table. The key column is assumed to be the first column in your table. The key is the column in the loaded attribute file used to match your attributes to your network. key colum for Network is the column in the Network that the key is matched to. (In this network there isn’t the ability to set this value because that is the only attribute associated with the nodes in our network but normally this drop box will be selectable) The key and matching column need to match perfectly (unless you have specifid that case does not matter). Similiar to the Import Network from Table, everything about the import is customizable. Cytoscape does its best to guess the datatypes of each column but you are able to fine tune it. There are also advanced options if you want to: change the file delimiter skip lines specify the header column Exercise 1c - Map node attributes to Visual Style Go to “Control Panel” on the left side and select the “Style” tab. Make sure that you are in the “Node” tab. Select the “Fill Color” field expand it by clicking on the right arrow. Set “Column” to “expression” and “Mapping Type” to “Continuous Mapping”. This will change the colours of the nodes to the default colour coding. Double click on the continuos mapping colour box to manually adjust the colour and other settings. At the bottom of the “Style” tab, check the box “Lock node width and height”. Select the “Size” field and expand it by clicking on the right arrow. Set “Column” to “mutation” and “Mapping Type” to “Continuous Mapping”. Your resulting network maps expression to the colour of the node and the size of the node to the number of mutations. Adjust the setting on the colour mapping. Change the colour scheme. Change the maximum and minimum values. Adjust the setting on the size mapping. Make the nodes bigger with higher values. Eventhough the network is small, play around with the layouts. Exercise 2 - Work with larger networks Cytoscape supplies a few demo networks that you can play around with. When you open cytoscape you are presented with a Start Panel where you can choose to reload a previous session or load in one of the sample networks. You do not need to re-open cytoscape to open the starter panel. Locate the Cytoscape top menu bar and select View,–&gt; Show Starter panel. Double click on the Affinity Purification Network to open it. If you already have a session open then you will recieve a warning that the current session will be lost. Before proceeding make sure your current session is saved. (Click on cancel. Then, File –&gt; Save as) Once the network has loaded you will see a network of protein interactions derived from an affinity purification experiment. Bait proteins are reprsented as pink hexagons and their corresponing prey proteins blue boxes. Using this larger network play around with the different layouts Search for the node “VPR” select all of the prey proteins associated with “VPR” Exercise 3 - Perform basic enrichment analysis using EnrichmentTable In Module 2 we performed detailed enrichment analysis with g:profiler and GSEA. We supplied gene lists and ranked expression sets in order to perform the analysis. What if you want to run a quick enrichment analysis with a given network or a given subset of the network? The easiest way to do this is to use the cytoscape app EnrichmentTable. EnrichmentTable will query g:profiler directly with the given network or subnetwork. Not all of the parameters that are available in the web version can be tweaked from the enrichmentmap table app but it can be an easy way to quickly see enrichment results. We will select the bait protein VPR and all its associated prey proteins to use for an enrichment analysis. Bait Protein - Is the labelled protein in an affinity purification experiment that is pulled down. Prey Protein - are the proteins that are associated with the bait protein when it is pulled down and are assumed to interact with the bait protein. First neighbor - are all the nodes that are directly connected to the given node 1. In the search bar enter “VPR”. Press enter. VPR is now the only highlighted node in the network. In order to select all its associated preys we need to select all the nodes that are connected to VPR, all of VPR’s first neighbours. There are two ways to select the first neighbours: In the top menu bar click on Select –&gt; Nodes –&gt; First neighbors of selected nodes –&gt; undirected Click on the first neighbor button, , in the quick links button set. Click on the “Enrichment Table” in the Table Panel. If the Enrichment Table tab is not in the Table Panel, Open Enrichment Table. Go to: Tools –&gt; Enrichment Table –&gt; Perform Gene Enrichment to launch Enrichment Table Tab. Click on the cog icon in the top right hand corner of the Enrichment Table panel This will bring up a panel with the adjustable settings. There are only 5 adjustable parameters- Organism - This shows a list of organisms that are available on the g:Profiler site. Gene ID column - the column in the current network that you want to use to search g:Profiler with. Ideally this should be a column specifying the Gene Name or other identifier. Multiple testing correction - change to fdr. Adjusted p-value threshold (min 0 max 1) - leave as 0.05. If you are getting too many results you can make this value smaller. Include inferred GO annotations (IEA) - by default the search will exclude inferred from electonic annotation GO terms. If you want to include them, select this option. By default, EnrichmentTable automatically uses all the databases available on the g:Profiler site. There is no way to filter prior to running the analysis. You need to filter the results after the analysis has been run. This will change the results because you end up filtering the results after the multiple correction and the multiple correction is dependent on the number of genesets you are testing with. Filter the EnrichmentTable results to show only GO:BP, Reactome and Wikipathway, similiar to what we used in Module 2. Click on the filter icon in the top left hand corner of the enrichment table results. Next to Select Categories select Gene Ontology Biological Process, Reactome, Wikipathways. To select multiple options click and hold command key on Mac or Shift on Windows. click on OK The EnrichmentTable will update to only include the sets from Gene Ontology Biological Process, Reactome, Wikipathways. Exercise 3B - create Enrichment Map and Enhanced graphics nodes from EnrichmentTable To create an Enrichment Map from the EnrichmentTable results, Click on the EM logo in the top left hand bar in the ErichmentTable Panel. This will bring up an EM options panel with very limited parameter adjustments. You can only change the name of the network and the connectivity threshold. You have already specified the p-value threshold when you originally performed the analysis. If you want to create your network with a more permissive q-value you need to go back to the EnrichmentTable search panel. Click on OK This will create an Enrichment Map in a new network and represents all the Gene Ontology Biological Process, Reactome, Wikipathways terms enriched for the VPR and its prey protein set. Exercise 4 - Load network from NDex NDex is an open-source repository where scientists can store, share, manipulate and publish biological network data. Networks are viewable on the web through their webapp but can also be downloaded directly into cytoscape so you can search, manipulate, integrate and analyze the given network for yourselves. For the purpose of this exercise we are going to load in a network from the publication A protein landscape of Breast Cancer. This publication is associated with multiple networks the the authors of this paper created and shared in NDex - https://www.ndexbio.org/index.html#/networkset/4423340d-e8e3-11eb-b666-0ac135e8bacf Start a new session. File –&gt; Close In the Network Search bar (located at the top of the control panel) make sure that the search provider is set to NDex. It should be set to NDex by default but click on down arrow to see the different data sources you can search for. Later in the workshop we will be using this bar to query GeneMania. Enter MCF7_All_PPI&gt;=0.9 into the search box, Click on the search icon. A search results box will appear. The MCF7_All_PPI&gt;=0.9 network is just one of the networks associated with this publication. Eventhough you are searching for this specific network, other networks associated with the original paper will also show up in the search results as well as others. Click on the green down arrow next to MCF7_All_PPI&gt;=0.9, the network will start to import. Once the network has been loaded, click on Close Dialog Resulting network loaded into cytoccape. Description taken from NDex record Baits are shown as yellow box, and preys as grey circle. Size of each node represents number of patients with alterations in each protein. Dotted line represents the physical protein-protein association (validated in other studies) with high Integrated Association Stringency score. Change the edge width to reflect the number of patients the associations is found in instead of the PPI score. Change the default node colour to blue. "],["gprofiler_mod3.html", "Module 3 Lab: g:profiler Visualization Goal of the exercise Data EnrichmentMap Description of this exercise Start the exercise Exercise 1a - compare different gprofiler geneset size results Exercise 1b - Is specifying the gmt file important? Exercise 1c - create EM from results using Baderlab genesets Exercise 1d (optional) - investigate individual pathways in GeneMANIA or String Bonus - Automation.", " Module 3 Lab: g:profiler Visualization This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Gary Bader, Ruth Isserlin, Chaitra Sarathy, Veronique Voisin Goal of the exercise Create an enrichment map and navigate through the network During this exercise, you will learn how to create an enrichment map from gene-set enrichment results. The enrichment results chosen for this exercise are generated using g:Profiler but an enrichment map can be created directly from output from GSEA, g:Profiler, GREAT, BinGo, Enrichr or alternately from any gene-set tool using the generic enrichment results (GEM) format. Data The data used in this exercise is a list of frequently mutated genes that we used in previous exercise. Pathway enrichment analysis has been run using g:Profiler and the results have been downloaded as a GEM format. EnrichmentMap A circle (node) is a gene-set (pathway) enriched in genes that we used as input in g:Profiler (frequently mutated genes). edges (lines) represent genes in common between 2 pathways (nodes). A cluster of nodes represent overlapping and related pathways and may represent a common biological process. Clicking on a node will display the genes included in each pathway. Description of this exercise We will run the saved g:Profiler results (from Module 2 - gprofiler lab) using different parameters. An enrichment map represents the result of enrichment analysis as a network where significantly enriched gene-sets that share a lot of genes in common will form identifiable clusters. The visualization of the results as these biological themes will ease the interpretation of the results. The goal of this exercise is to learn how to: Upload g:Profiler results into Cytoscape EnrichmentMap to create a map. Upload several g:Profiler results at the same time to create one map and learn how to distinguish and compare the results. To compare the differences resulting from the use of different g:Profiler parameters at the enrichment map level. Start the exercise To start the lab practical section, first create a gprofiler_files directory on your computer and download the files below. Right click on link below and select “Save Link As…”. Place it in the corresponding module directory of your CBW work directory. Five files are needed for this exercise: Enrichment result 1: gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000.gem.txt In g:Profiler, the parameters that we used to generate this file were: GO_BP no electronic annotation, Reactome, WikiPathways, Benjamini-Hochberg FDR 0.05 The results were filtered using the Term size slidebar. Only the enriched gene-sets containing more than 3 and less than or equal to 10000 genes per gene-set were included in the result file. Enrichment result 2: gProfiler_hsapiens_lab2_results_GEM_termmin3_max250.gem.txt In g:Profiler, the parameters that we used were: GO_BP no electronic annotation, Reactome, WikiPathways, Benjamini-HochBerg FDR 0.05. The results were filtered using the Term size slidebar. Only the enriched gene-sets that contain more than 3 and less than or equal to 250 genes per gene-set were included in the result file. Enrichment result 3: gProfiler_hsapiens_Baderlab_max250.gem.txt Pathway database 1: gprofiler_full_hsapiens.name.gmt This file can be downloaded directly or can be been created by concatenating the hsapiens.GO/BP.name.gmt, hsapiens.WP.namt.gmt and the hsapiens.REAC.name.gmt files contained in the g:Profiler gprofiler_hsapiens.name folder. Pathway database 2: Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol_max250.gmt Exercise 1a - compare different gprofiler geneset size results Step 1 Launch Cytoscape and open the EnrichmentMap App 1a. Double click on Cytoscape icon 1b. Open EnrichmentMap App In the Cytoscape top menu bar: Click on Apps -&gt; EnrichmentMap A ‘Create Enrichment Map’ window is now opened. Step 2 Create an enrichment map from 2 datasets and with a gmt file. 2a. In the ‘Create Enrichment Map’ window, drag and drop the 2 enrichment files gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000.gem.txt and gProfiler_hsapiens_lab2_results_GEM_termmin3_max250.gem.txt. 2b. In the white box, click on “gProfiler_hsapiens_lab2_results_GEM_termmin3_max250 (Generic/gProfiler)” 2c. On the right side, go to the GMT field, click on the 3 radio button (…) and locate the file gprofiler_full_hsapiens.name.gmt that you have saved on your computer to upload it. 2d. In the white box, click on “gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000 (Generic/gProfiler)” 2e. On the right side, go to the GMT field, click on the 3 radio button (…) and locate the file gprofiler_full_hsapiens.name.gmt that you have saved on your computer to upload it. 2f. Locate the FDR q-value cutoff field and set the value to 0.001 2g. Select the Connectivity slide bar to sparse. Intstead of specifying the gmt file for each dataset separately, if all the dataasets in your analysis use the same gmt file, you can specify a common gmt file to be used by all datasets. Click +Add… and select Add Common Files On the right side, go to the GMT file field, click on the 3 radio button (…) and locate the file gprofiler_full_hsapiens.name.gmt that you have saved on your computer to upload it. This can also be done for a shared expression file. 2h. Click on Build. If you have specified common files this info box will appear * Click on Continue to build A status bar should pop up showing progress of the Enrichment map build. There might be multiple messages that appear when you first create an enrichment map. You can choose to silence them if you want (Although the yfiles message will continue to appear every two weeks). * Click on OK * Click on OK Step3: Explore the results: In the EnrichmentMap control panel located at the left: Select the 2 Data Sets (checked by default) Set Chart Data o Color by Data Set Select Publication Ready to remove gene-set label to have a global view of the map. un-select Publication Ready when you explore the map in more detail to see the gene-set names. On the map, a node that is coloured both green and blue is a gene-set that is found in the both of the 2 gProfiler result sets that we have been uploaded. A node that is blue is a gene-set that is found only in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000 . A node that is green is a gene-set that is found only in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max250 . A blue edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000. A green edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max250.gem. We can see clusters of blue nodes. All these nodes contain gene-sets that have more than 250 genes. Explore the detailed view (see below) to see if this cluster corresponds to informative terms. Would you have lost information by filtering gene-sets larger than 250 genes? Explore Detailed results In the Cytoscape menu bar, select ‘View” and ’Show Graphic Details’ to display node labels. Make sure you have unselected “Publication Ready” in the EnrichmentMap control panel. Zoom in to be able to read the labels and navigate the network using the bird eye view (blue rectangle). Select a node and visualize the Table Panel Click on a node For this example the node “Signaling by Notch” has been selected. you can type it in the search bar, quotes are important. When the node is selected, it is highlighted in yellow. In table panel, we can see the genes included in the gene-set. A green colored box indicates that the gene is in the gene-set(pathway) and in our gene list. A gray colored box indicated that the gene is in the gene-set but not in our gene list. Exercise 1b - Is specifying the gmt file important? Create an enrichment map without a gmt file to compare the results with Exercise 1a. Go to Control Panel and select the EnrichmentMap tab. Click on the “+” sign to re-open the Create Enrichment Map window. In the white box, select the “gProfiler_hsapiens_lab2_results_GEM_termmin3_max250.gem (Generic/gProfiler)” file Locate the GMT field and delete the file name, leaving it blank. In the white box, select the “gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000 (Generic/gProfiler)” file Locate the GMT field and delete the file name , leaving it blank. Use same parameters as in exercise 1a: FDR q-value cutoff of 0.001 and Connectivity to sparse. Click on Build Explore the results: In the EnrichmentMap control panel located at the left: Select the 2 Data Sets (selecteded by default) Set Chart Data o Color by Data Set Select Publication Ready to remove gene-set label to have a global view of the map. Uncheck this box when you explore the map in details to see the gene-set names. On the map, a node that is coloured both green and blue is a gene-set that is found in the both of the 2 gProfiler result sets that we have been uploaded. A node that is blue is a gene-set that is found only in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000 . A node that is green is a gene-set that is found only in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max250 . A blue edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max10000. A green edge represents genes that overlap between gene-sets found in the file gProfiler_hsapiens_lab2_results_GEM_termmin3_max250.gem. Conclusion of exercises 1 a and 1b: Loading a gmt file to create an enrichment map from g:Profiler result is optional. However, there are 2 main beneficial aspects to uploading a gmt file: The map will be less condensed and easier to read and interpret. Clicking on a node will display all genes in the gene-set and not only genes included in our query list. Exercise 1c - create EM from results using Baderlab genesets Create an enrichment map from the results of g:Profiler generated using the custom Baderlab gene-set file. To get a map that is easy to read and that does not display too many gene-sets, one option is to focus the analysis on gene-sets (pathways) that contain 250 genes or less. We prefiltered our pathway database prior to upload it into g:Profiler so that FDR is calculated only on these gene-sets (as opposed to exercise 1a where the FDR was calculated on all gene-sets and then some gene-sets &gt; 250 genes were excluded from the result file). For this exercise, we will use: Filtered gmt file: Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol_max250.gmt. We have uploaded this file as a custom gmt file in g:Profiler and run the query. (in Module 2 lab) To create an enrichment map of these results: Go to Control Panel and select the EnrichmentMap tab. Click on the “+” sign to re-open the Create Enrichment Map window. Click on Reset to reset the Enrichment map panel Drag the file that we created in Module 2 lab gProfiler_hsapiens_Baderlab_max250.gem.txt and the filtered gmt file (Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol_max250.gmt into the Datasets box on Enrichment map panel. In the white box, select the “gProfiler_hsapiens_Baderlab_max250.gem.txt (Generic/gProfiler)” file Locate the GMT field and upload the file “Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol_max250.gmt”. Set the FDR q-value cutoff to 0.001 and set the Connectivity slide bar to second level. Explore the results: SAVE YOUR CYTOSCAPE SESSION (.cys) FILE ! Exercise 1d (optional) - investigate individual pathways in GeneMANIA or String Each node in the Enrichment map represents a biological process or pathway. It consists of a collection of genes. Often we want to know how the genes in that group interact. There are many different ways you can investigate the underlying interactions for the given group. Some involve searching online databases and others are directly integrated into cytoscape. GeneMANIA - an integrative database of gene connections including co-expression, protein interactions, genetic interactions, pathways and more. Cytoscape App String - an integrative database of gene connections including co-expression, protein interactions, genetic interactions, pathways and more. Cytoscape App Pathway Commons - a intergrative database of pathways. (There is a beta feature in EM to show your pathway in the painter app, a pathway common web page that overlays your expression data on the given pathway. Still in beta testing and requires expression data to work correctly so won’t work for this example) GeneMANIA Navigate to the enrichment map that you created using the Baderlab genesets Click on Network Tab and navigate to the third network (it should be the third network if you followed the above examples - name: gProfiler_hsapiens_Baderlab_max250_gem) or in the Enrichment map panel in the top drop down select the network named gProfiler_hsapiens_Baderlab_max250_gem In the cytoscape search bar enter “Signaling by Notch” If you can’t see the selected nodes, click on “Fit Selected” to focus on the selected node. Right click on the node “Signaling by Notch” and Select Apps –&gt; Enrichmemt Map - Show in GeneMANIA A GeneMANIA Query Panel will pop up. Select Select genes with expression to reduce the query set to just the genes in the given pathway that was in your original dataset (for example we search for a set of 127 genes in g:profiler but the given pathway has 233 genes associated with it of which only 10 genes are found in our original query set ) Click on OK A GeneMANIA network will show up with the connections between the genes found in your query set and the pathway “Signaling by Notch” We will go more in depth into GeneMANIA in module 5 String Navigate to the enrichment map that you created using the Baderlab genesets Click on Network Tab and navigate to the third network (it should be the third network if you followed the above examples - name: gProfiler_hsapiens_Baderlab_max250_gem) or in the Enrichment map panel in the top drop down select the network named gProfiler_hsapiens_Baderlab_max250_gem In the cytoscape search bar enter “Signaling by Notch” If you can’t see the selected nodes, click on “Fit Selected” to focus on the selected node. Right click on the node “Signaling by Notch” and Select Apps –&gt; Enrichmemt Map - Show in String A String Query Panel will pop up. Select Select genes with expression to reduce the query set to just the genes in the given that pathway that was in your original dataset (for example we search for a set of 127 genes in g:profiler but the given pathway has 233 genes associated with it of which only 10 genes are found in our original query set ) Click on OK A String network will show up with the connections between the genes found in your query set and the pathway “Signaling by Notch” Explore the features and data of each Cytoscape app.What sort of information does each tell you? What is the main difference between the two resulting networks? Bonus - Automation. Run analysis directly from R for easy integration into existing pipelines. Instead of creating an Enrichment map manually through the user interface you can create an enrichment map directly using the RCy3 bioconductor package or through direct rest calls with Cytoscape cyrest. Follow the step by step instructions on how to run from R here - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/create-enrichment-map-from-r-with-gprofiler-results.html First, make sure your environment is set up correctly by following there instructions - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/setup.html "],["gsea_mod3.html", "Module 3 Lab: GSEA Visualization Goal of the exercise: Data Exercise 1 - GSEA output and EnrichmentMap Exercise 2 - Post analysis (add drug target gene-sets to the network) Exercise 3 - Autoannotate the Network Exercise 4 (Optional) - Explore results in GeneMANIA or STRING Bonus - Automation.", " Module 3 Lab: GSEA Visualization This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Veronique Voisin, Ruth Isserlin, Gary Bader Goal of the exercise: Exercise 1 - Create an enrichment map and navigate through the network During this exercise, you will learn how to create an EnrichmentMap from gene-set enrichment results. The enrichment tool chosen for this exercise is GSEA but an enrichment map can be created from output from GSEA, g:Profiler, GREAT, BinGo, Enrichr or alternately from any gene-set tool using the generic enrichment results format. Exercise 2 - Post analysis (add drug target gene-sets to the network) As second part of the exercise, you will learn how to expand the network by adding an extra layer of information. Exercise 3 - Autoannotate A last optional exercise guides you through the creation of automatically generated cluster labels to the network. Data The data used in this exercise is gene expression data obtained from high throughput RNA sequencing. The data correspond to Pancreatic Ductal Adenocarcinoma samples (TCGA-PAAD). We use precomputed results of the GSEA analysis Module 2 lab - gsea to create an enrichment map with the aim to transform the tabular format to a network so we can better visualize the relationships between the significant gene-sets: GSEA outpus an entire directory of files and results. For the purpose of this analysis we only need two tables found in the output directory. The output result tables are: One table (pos) contains all pathways with an enrichment score (significant or not) related to enrichment of the basal category (positive score). (By default called - gsea_report_for_na_pos_#############.tsv) One table (neg) contains all pathways with an enrichment score (significant or not) related to enrichment of the classical category (negative score). (By default called - gsea_report_for_na_neg_#############.tsv) These 2 tables are uploaded using the EnrichmentMap App which will create a network of basal and classical pathways that have a significant score (FDR &lt;= 0.05) for clearer visualization of the results. EnrichmentMap A red circle (node) is a pathway specific of the mesenchymal type. (or pathway with mostly positively ranked genes) A blue circle (node) is a pathway specific of the immunoreactive type. (or pathway with mostly negatively ranked genes) An edge represents genes in common between 2 pathways (nodes). A cluster of nodes represent overlapping and related pathways and may represent a common biological process or theme. Clicking on a node will display the genes included in each pathway. Exercise 1 - GSEA output and EnrichmentMap To start the lab practical section, first download the files. Right click on link below and select “Save Link As…”. Place it in the corresponding module directory of your CBW work directory. 7 Files are needed to create the enrichment map for this exercise (please download these files on your computer or alternately use the GSEA directory created in module 2 lab - gsea for files 1,2,3) : GMT (file containing all pathways and corresponding genes) - Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol.gmt Enrichments 1 (GSEA results for the “pos” basal subtype) - gsea_report_for_na_pos_1717773429384.tsv Enrichments 2 (GSEA results for the “neg” Classical subtype) - gsea_report_for_na_neg_1717773429384.tsv Expression (file containing the RNAseq data for all samples and all genes) - TCGA-PAAD_GDC_BasalvsClassical_normalized_rnaseq.txt Rank file (file that has been used as input to GSEA) - TCGA-PAAD_GDC_Subtype_Moffitt_BasalvsClassical_ranks.rnk Classes (define which samples are basal and which samples are classical) - TCGA-PAAD_Subtype_Moffitt_BasalvsClassical_RNAseq_classes.cls Drug target database (preselection of 7 drugs and their target genes in the post analysis exercise, http://www.drugbank.ca/) - Human_DrugBank_all_symbol_June_01_2024_selected.gmt Follow the steps described below at your own pace: Step 1 Launch Cytoscape and open EnrichmentMap App 1a. Double click on the Cytoscape icon 1b. Open EnrichmentMap App In the top menu bar: Click on Apps -&gt; EnrichmentMap A ’Create EnrichmentMap window is now opened. Step 2 Create an enrichment map 2a. In the ‘Create EnrichmentMap’ window, add a dataset of the GSEA type by clicking on the ‘+ADD…’ –&gt; ‘+ add data set manually’. 2b. Specify the following parameters and upload the specified files: Name: leave default or a name of your choice like “GSEAmapPAAD_Basal_vs_Classical” Analysis Type: GSEA Enrichments Pos: gsea_report_for_na_pos_1717773429384.tsv Enrichments Neg: gsea_report_for_na_neg_1717773429384.tsv GMT : Human_GOBP_AllPathways_noPFOCR_no_GO_iea_June_01_2024_symbol.gmt Ranks: TCGA-PAAD_GDC_Subtype_Moffitt_BasalvsClassical_ranks.rnk Expressions : TCGA-PAAD_GDC_BasalvsClassical_normalized_rnaseq.txt This field is optional but recommended. Classes: TCGA-PAAD_Subtype_Moffitt_BasalvsClassical_RNAseq_classes.cls This field is optional. Phenotypes: In the text boxes place Basal as the Positive phenotype Classical as the Negative phenotype. Basal will be associated with red nodes because it corresponds to the positive phenotype and Classical will be associated with the blue nodes because it corresponds to the negative phenotype. Set FDR q-value cutoff to 0.05 (= only gene-sets significantly enriched at a value of 0.05 or less will be displayed on the map). If the cutoff is set to a very small number, for exaxmple 0.0001, it will be displayed as 1E-04 in the scientific notation. 2c. Click on Build We populated the fields manually. If you work with your own data, a way to populate automatically the fields is to drag and drop your GSEA folder in the ‘Data Set’ window. You are encouraged to give it a try once you finished the lab with your own GSEA results. Unformatted results: layout will be different for each user (there is a random seed in the layout algorithm) but it does not change the results or interpretation (the connections are the same, only the display is different). Step 3 Navigate the enrichment map to gain a better understanding of a EnrichmentMap network. General layout of Cytoscape panel: In addition to the main window where the network is displayed, there are 2 panels: the Control Panel on the left side and the Table Panel at the bottom of the window. Steps: 3a. In the Cytocape menu bar, select View and Always Show Graphic details. It will turn the squared nodes into circles and the gene-set labels will be visible. 3b: Zoom in or out using + or - in toolbar or scroll button on mouse until you are able to read the labels comfortably. 3c: Use the bird’s eye view (located at the bottom of the control panel) to navigate around the network by moving the blue rectangle using the mouse or trackpad. 3d: Click on an individual node of interest. For this example, you could use TGF-BETA RECEPTOR SIGNALING ACTIVATES SMADS. If you are unable to locate TGF-BETA RECEPTOR SIGNALING ACTIVATES SMADS, type “TGF-BETA RECEPTOR SIGNALING ACTIVATES SMADS” in the search box (quotes are important). Selected nodes appear yellow (or highlighted) in the network. 3e. In the Table Panel in the EM Heat map tab change: Expressions: Row Norm Compress: -None- Genes in the heatmap that are highlighted yellow (rank column) represent genes that are part of the leading edge for this gene set, i.e. contributed the most to the enriched phenotype. Leading edge genes will only be highlighted if an individual node has been selected and the Enrichment Map was created from GSEA results. Troubleshooting: if you don’t see the sort column highlighted in yellow, reselect the node of interest and click on the GSEARanking Data Set 1 text in the EM Heatmap tab. Step 4 Use Filters to automatically select nodes on the map: Move the blue nodes to the left side of the window and the red nodes to the right side of the window. 4a. Locate the Filter tab on the side bar of the Control Panel. 4b. Click on the + sign to view the menu and select Column Filter. 4c. From the Choose column … box, select Node: NES(PAAD_Basal_vs_Classical) and set filter values from -2.242 and 0 inclusive. 4d. The blue nodes are now automatically selected. Zoom out to be able to look at the entire network and drag all blue nodes to the left side of the screen. 4e. Optional. Change is to is not to select the red nodes. The red pathways (nodes) are specific to the Basal subtype. They were listed in the pos table of the GSEA results. The enrichment score (ES) values in this table are all positive values. The blue pathways are specific to the Classical subtype and were listed in the neg table of the GSEA results. The ES values in this table are all negative values. This is the information we used as the filtering criteria. Exercise 2 - Post analysis (add drug target gene-sets to the network) Step 5 Add drug target gene-sets to the network (Add Signature Gene-Sets…). 5a. In Control Panel, go to the EnrichmentMap tab and click on “Options…” located above the ‘Data Sets:’ box. Select “Add Signature Gene Sets…”. A window named “EnrichmentMap: Add Signature Gene Sets (Post-Analysis) is now opened. 5b. Using the ‘Load from File…’ button, select the Human_DrugBank_approved_symbol_June_01_2024_selected.gmt file that you saved on your computer. 5c. Click on “Finish”. Two additional nodes are now added to the network and visible as grey diamonds. Dotted orange edges represent their overlap with the nodes of our network. These additional nodes represent gene targets of some approved drugs and these genes are either specific of the basal type (dotted orange edges connected to red nodes) or specific of the classical type (dotted orange edges connected to blue nodes). The remaining five drugs that do not pass the threshold in this map are other drugs currently used in treatment of pancreatic cancer. more info using this link: https://enrichmentmap.readthedocs.io/en/latest/PostAnalysis.html Exercise 3 - Autoannotate the Network Step 6 By default, Enrichment map will Auto-annotate the network with cluster labels. The Apps WordCloud, ClusterMaker and Autoannotate have to be installed. (they should have been installed during the pre-workshop set up) if you ran step 5, delete the drug targets diamond nodes and associated edge before performing step 6: * select the 4 nodes and associated dotted orange edges by browsing the mouse and * click “delete” on your keyboard or * in the Cytoscape menu, ‘Edit’, ‘Delete Selected Nodes and Edges’. Alternately, in the Enrichment Map Input Panel in the Datasets box, un-select “Human_Drugbank_approved_symbol_June_01_2024_selected” to hide the post analysis nodes. The “annotations” are hidden but the node of each computed cluster that has the most significant FDR value is shown with a larger node label. 6a. To modify these precomputed annotations find the Auto annotate display panel on the right or Auto annotate input panel on the left. The right panel will contain all the different settings you can set for the annotations. By default the annotations and their labels are hidden. The left panel allows you to see all the different clusters and their labels. You can select one of many of them, change their labels or recompute the clusters with predefined clusters or one of many avaialble methods amoungst other settings. See the docs for all the available features. Unhide labels and shapes to see the underlying annotation for the network. The network is now subdivided into clusters that are represented by ellipses. Each of these clusters are composed of pathways (nodes) interconnected by many common genes. These pathways represent similar biological processes. The app WordCloud take all the labels of the pathways in one cluster and summarize them as a unique cluster label displayed at the top of each ellipse. Tip 1: further editing and formatting can be performed on the AutoAnnote results using the AutoAnnotate Display in the Results Panels located at the right side of the window. For example, it is possible to change Ellipse to Rectangle, uncheck Scale font by cluster size and increase the Font Scale using the scaling bar. It is also possible to reduce the length of the cluster label by checking the “Word Wrap” option. Tip 2: The AutoAnnotate window on the left side in Result Panel contains the list of all clusters. Clicking on a cluster label will highlight in yellow all nodes in this cluster. It is then easy to move the nodes using the mouse to avoid cluster overlaps. Exercise 4 (Optional) - Explore results in GeneMANIA or STRING Each node in the Enrichment map represents a biological process or pathway. It consists of a collection of genes. Often we want to know how the genes in that group interact. There are many different ways you can investigate the underlying interactions for the given group. Some involve searching online databases and others are directly integrated into cytoscape. GeneMANIA - an integrative database of gene connections including co-expression, protein interactions, genetic interactions, pathways and more. Cytoscape App String - an integrative database of gene connections including co-expression, protein interactions, genetic interactions, pathways and more. Cytoscape App Pathway Commons - a intergrative database of pathways. (There is a beta feature in EM to show your pathway in the painter app, a pathway common web page that overlays your expression data on the given pathway. Still in beta testing and requires expression data to work correctly so won’t work for this example) Step 7 Visualize genes in a pathway/node of interest using the apps STRING and GeneMANIA. This will create a protein-protein interaction network using the genes included in the pathway. Note: We will go more in depth into GeneMANIA in module 5 7a: Click on an individual node of interest. For this example, you could use xenobiotic metabolic process. If you are unable to locate xenobiotic metabolic process, type “xenobiotic metabolic process” in the search box (quotes are important). The selected node appears yellow (or highlighted) in the network. If you have annotated your network, it should be included in the response xenobiotic stimulus cluster. 7b: Right Click on the node of interest to diplay the option menu. Select Apps,–&gt; EnrichmentMap - Show in STRING Patience. :) . It might take a few seconds for the String Protein Query window to open. A STRING Protein Query box appears. Select Select genes with expression. Click on OK. The resulting network will look something like this. Explore the features and data of each Cytoscape app.What happens to the network if you change the initial parameters like Confidence cutoff or Max Additional interactors 7c:Go back to enrichment map network. In Control Panel (left side of the window), select the “Network” tab and click on the Enrichment Map network as shown in below screenshot. 7d: Search again for the node labelled xenobiotic metabolic process (if it is not still selected) as in Step 7a. Right Click on the node of interest to diplay the option menu. Select Apps,–&gt; EnrichmentMap - Show in GeneMANIA A GeneMANIA Query box appears. select Select genes with expression. Click on OK. A pop up will appear indicating that it is currenlty querying GeneMANIA The resulting network will look similiar to the below screenshot. It is possible to view gene expression data for the nodes in the STRING network. See the section https://enrichmentmap.readthedocs.io/en/latest/Integration.html and try it out after the workshop. SAVE YOUR SESSION FILE! Bonus - Automation. Run analysis directly from R for easy integration into existing pipelines. Instead of creating an Enrichment map manually through the user interface you can create an enrichment map directly using the RCy3 bioconductor package or through direct rest calls with Cytoscape cyrest. Follow the step by step instructions on how to run from R here - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/create-enrichment-map-from-r-with-gsea-results.html First, make sure your environment is set up correctly by following there instructions - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/setup.html "],["automation.html", "Module 3 Lab: (Bonus) Automation Goal of the exercise: Set Up - Option 1 - Install R/Rstudio Set Up - Option 2 - Docker image with R/Rstudio Install Docker Create your first notebook using Docker Start using automation Running example notebooks in local RStudio", " Module 3 Lab: (Bonus) Automation This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 Unported License. This means that you are able to copy, share and modify the work, as long as the result is distributed under the same license. By Ruth Isserlin Although a lot of what we have demonstrated in Cytoscape up until now has been manual most of the features we use can be automated through multiple access points including: R/Rstudio using RCy3 - a bioconductor package that makes communicating with cytoscape as simple as calling a method. Python using py2cytoscape. directly through cyrest using rest calls - you can use any programming language with the rest API. See Cytoscape Automation Automation becomes helpful when performing pipelines multiple times on similiar datasets or integrating cytoscape data into your other pipelines. Below we demonstrate how to perform the enrichment map pipeline from R but automation is not limited to this access point. You can automate it from any flavour of programming. Check out all the ways you can interact with Cytoscape here including directly through the cytoscape command window. Goal of the exercise: Run an enrichment analysis and Create an enrichment map automatically from R/Rstudio During this exercise, you will apply what you have learnt in Module 2 labs and Module 3 labs but instead of performing them manually you will automate the process using R/Rstudio. We will use all the same data and programs we used in the previous labs but we will control them from R. Before starting this exercise you need to set up R/Rstudio. You can do that directly on your machine or through docker. Set Up - Option 1 - Install R/Rstudio Install R. Go to: https://cran.rstudio.com/ If installing on Windows select “install R for the first time” to get to the required package. RStudio is a free IDE (Integrated Development Environment) for R. RStudio is a wrapper1 for R and as far as basic R is concerned, all the underlying functions are the same, only the user interface is different (and there are a few additional functions that are very useful e.g. for managing projects). Here is a small list of differences between R and RStudio. pros (some pretty significant ones actually): Integrated version control. Support for “projects” that package scripts and other assets. Syntax-aware code colouring. A consistent interface across all supported platforms. (Base R GUIs are not all the same for e.g. Mac OS X and Windows.) Code autocompletion in the script editor. (Depending on your point of view this can be a help or an annoyance. I used to hate it. After using it for a while I find it useful.) “Function signaturtes” (a list of named parameters) displayed when you hover over a function name. The ability to set breakpoints for debugging in the script editor. Support for knitr, and rmarkdown; also support for R notebooks … (This supports “literate programming” and is actually a big advance in software development) Support for R notebooks. cons (all minor actually): The tiled interface uses more desktop space than the windows of the R GUI. There are sometimes (rarely) situations where R functions do not behave in exactly the same way in RStudio. The supported R version is not always immediately the most recent release. Navigate to the RStudio download Website. Find the right version of the RStudio Desktop installer for your computer, download it and install the software. Open RStudio. Focus on the bottom left pane of the window, this is the “console” pane. Type getwd(). This prints out the path of the current working directory. Make a (mental) note where this is. We usually always need to change this “default directory” to a project directory. Set Up - Option 2 - Docker image with R/Rstudio Changing versions and environments are a continuing struggle with bioinformatics pipelines and computational pipelines in general. An analysis written and performed a year ago might not run or produce the same results when it is run today. Recording package and system versions or not updating certain packages rarely work in the long run. One the best solutions to reproducibility issues is containing your workflow or pipeline in its own coding environment where everything from the operating system, programs and packages are defined and can be built from a set of given instructions. There are many systems that offer this type of control including: Docker. Singularity “A container is a standard unit of software that packages up code and all its dependencies so the application runs quickly and reliably from one computing environment to another.” (Merkel 2014) Why are containers great for Bioiformatics? allows you to create environments to run bioinformatis pipelines. create a consistent environment to use for your pipelines. test modifications to the pipeline without disrupting your current set up. Coming back to an analysis years later and there is no need to install older versions of packages or programming languages. Simply create a container and re-run. What is docker? Docker is a container platform, similar to a virtual machine but better. We can run multiple containers on our docker server. A container is an instance of an image. The image is built based on a set of instructions but consists of an operating system, installed programs and packages. (When backing up your computer you might taken an image of it and restored your machine from this image. It the same concept but the image is built based on a set of elementary commands found in your Dockerfile.) - for overview see here Often images are built off of previous images with specific additions you need for you pipeline. (For example, for this course we use a base image supplied by bioconductorrelease 3.11 and comes by default with basic Bioconductor packages but it builds on the base R-docker images called rocker.) Docker - Basic term definition Container An instance of an image. the self-contained running system. There can be multiple containers derived from the same image. Image An image contains the blueprint of a container. In docker, the image is built from a Dockerfile Docker Volumes Anything written on a container will be erased when the container is erased ( or crashes) but anything written on a filesystem that is separate from the contain will persist even after a container is turned off. A volume is a way to assocaited data with a container that will persist even after the container. * maps a drive on the host system to a drive on the container. In the above docker run command (that creates our container) the statement: -v ${PWD}:/home/rstudio/projects maps the directory ${PWD} to the directory /home/rstudio/projects on the container. Anything saved in /home/rstudio/projects will actually be saved in ${PWD} An example: I use the following commmand to create my docker container: docker run -e PASSWORD=changeit --rm \\ -v /Users/risserlin/code:/home/rstudio/projects \\ -p 8787:8787 \\ risserlin/workshop_base_image I create a notebook called task3.Rmd and save it in /home/rstudio/projects. Note: Do not save it in /home/rstudio/ which is the default directory RStudio will start in On my host computer, if I go to /Users/risserlin/code I will find the file task3.Rmd Install Docker Download and install docker desktop. Follow slightly different instructions for Windows or MacOS/Linux Windows it might prompt you to install additional updates (for example - https://docs.Microsoft.com/en-us/windows/wsl/install-win10#step-4---download-the-linux-kernel-update-package) and require multiple restarts of your system or docker. launch docker desktop app. Open windows Power shell navigate to directory on your system where you plan on keeping all your code. For example: C:\\USERS\\risserlin\\code Run the following command: (the only difference with the windows command is the way the current directory is written. ${PWD} instead of \"$(pwd)\") docker run -e PASSWORD=changeit --rm \\ -v ${PWD}:/home/rstudio/projects -p 8787:8787 \\ risserlin/workshop_base_image Windows defender firewall might pop up with warning. Click on Allow access. In docker desktop you see all containers you are running and easily manage them. MacOS / Linux Open Terminal navigate to directory on your system where you plan on keeping all your code. For example: /Users/risserlin/code Run the following command: (the only difference with the windows command is the way the current directory is written. ${PWD} instead of \"$(pwd)\") docker run -e PASSWORD=changeit --rm \\ -v &quot;$(pwd)&quot;:/home/rstudio/projects -p 8787:8787 \\ risserlin/workshop_base_image Create your first notebook using Docker Start coding! Open a web browser to localhost:8787 enter username: rstudio enter password: changeit changing the parameter -e PASSWORD=changeit in the above docker command will change the password you need to specify When you go to localhost:8787 all you get is: Make sure your docker container is running. (If you rebooted your machine you will need to restart the container on reboot.) Make sure you got the right port. After logging in, you will see an Rstudio window just like when you install it directly on your computer. This RStudio will be running in your docker container and will be a completely separate instance from the one you have installed on your machine (with a different set of packages and potentially versions installed). Make sure that you have mapped a volume on your computer to a volume in your container so that files you create are also saved on your computer. That way, turning off or deleting your container or image will not effect your files. The parameter -v ${PWD}:/home/rstudio/projects maps your current directory (i.e. the directory you are in when launching the container) to the directory /home/rstudio/projects on your container. You do not need to use the ${PWD} convention. You can also specify the exact path of the directory you want to map to your container. Make sure to save all your scripts and notebooks in the projects directory. Create your first notebook in your docker Rstudio. Save it. Find your newly created file on your computer. Start using automation Download example R notebooks from https://github.com/risserlin/CBW_pathways_workshop_R_notebooks. This repository contains example R Notebooks that automate the CBW pipeline. There are two ways you can download this collection: If you are familiar with git then we recommend you fork the repo and use it like you would use any github repo. download the collection as a zip file - unzip folder and place in CBW working directory If you are new to git and want to learn more about code versioning then we recommend you read the following tutorial And check out Github Desktop - a desktop application to communicate with github. Running example notebooks in local RStudio Highly recommended to use docker instead of local RStudio. If you are using local RStudio, versions of R and associated packages may be different than the ones used in the example notebooks and might require installing updated versions and additional packages. Step 1 - launch RStudio Launch RStudio by double clicking on the installed program icon. Step 2 - create a new project Create a new project - File -&gt; New R Project … Select Create project from - “Existing Directory” Click on the Browse button Navigate to the CBW_pathways_workshop_R_notebooks directory that is found in the directory you downloaded and unzipped from github. (for example, if it is still in your downloads directory go to ~/Downloads/Cytoscape_workflows/CBW_pathways_workshop_R_notebooks) Step 3 - Open example RNotebook Open the RNotebook 07-Create_EM_from_GSEA_results.Rmd Go to File –&gt; Open File … Click on 07-Create_EM_from_GSEA_results.Rmd If the file is not found in the first directory that RStudio opens up then go back and make sure that you created an Rproject from an “Existing directory” in the previous step. Step 4 - Step through notebook to run the analysis The RNotebook is a mixture of markdown text and code blocks. Read through the notebook to understand what each section is doing and sequentially run the code blocks by clicking on the play button at the top right of each code block. Run analysis directly from R for easy integration into existing pipelines. Instead of creating an Enrichment map manually through the user interface you can create an enrichment map directly using the RCy3 bioconductor package or through direct rest calls with Cytoscape cyrest. Follow the step by step instructions on how to run from R here - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/create-enrichment-map-from-r-with-gsea-results.html First, make sure your environment is set up correctly by following there instructions - https://risserlin.github.io/CBW_pathways_workshop_R_notebooks/setup.html Exercises Once you have run through the notebook and created your enrichment map automatically try the following: change the fdr threshold and create a new network (without rerunning the whole notebook) with the lower FDR threshold. change the similarity coeffecient and create a new network (without rerunning the whole notebook) with the lower FDR threshold. re-run the notebook using the GSEA results you created on the first run without running GSEA. Modify notebook to run with a different gmt file. (Downloaded from somewhere else or a different file found on baderlab genesets download site) Open the notebook Supplementary_Protocol5_Multi_dataset_theme_analysis.Rmd and run through it to create a multi dataset enrichment map. Additional resources Check out all the different notebooks available here Merkel, Dirk. 2014. “Docker: Lightweight Linux Containers for Consistent Development and Deployment.” Linux Journal 2014 (239): 2. References Merkel, Dirk. 2014. “Docker: Lightweight Linux Containers for Consistent Development and Deployment.” Linux Journal 2014 (239): 2. A “wrapper” program uses another program’s functionality in its own context. RStudio is a wrapper for R since it does not duplicate R’s functions, it runs the actual R in the background.↩︎ "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
